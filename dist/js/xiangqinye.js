"use strict";var reg=/id=(\d+)/;reg.test(location.search)||(location.href="../html/list.html");var id=reg.exec(location.search)[1],data=$.ajax({url:"../api/getDetail.php",data:{id:id},dataType:"json",success:function(t){renderHtml(t.detail),enlarge(),$(".btn-group").on("click","button",function(){$(this).addClass("act").siblings().removeClass("act")})}});function renderHtml(t){var n=t.goods_price/3,e=t.goods_price/6,o=t.goods_price/12;str='\n    <ol class="breadcrumb">\n    <li><a href="#">'+t.goods_introduce+'</a></li>\n</ol>\n<div class="media">\n    <div class="media-left box1">\n        <div class="show1">\n            <img class="media-object" src="'+t.goods_logo+'" alt="...">\n            <div class="mask"></div>\n        </div>\n        <div class="enlarge"></div>\n    </div>\n    \n    <div class="media-body">\n        <h4 class="media-heading">'+t.goods_name+"</h4>\n        <p>"+t.goods_detail_2+'</p>\n        <div class="price">\n            <i class="glyphicon glyphicon-yen"></i>\n            <span>'+t.goods_price+'</span>\n        </div>\n        <p>颜色</p>\n        <div class="btn-group" role="group" aria-label="...">\n            <button type="button" class="btn btn-default">松深如墨</button>\n            <button type="button" class="btn btn-default">十七度灰</button>\n            <button type="button" class="btn btn-default">AG梦幻独角兽</button>\n            <button type="button" class="btn btn-default">AG星际灰</button>\n            <button type="button" class="btn btn-default">AG原野绿</button>\n        </div>\n        <p>套餐</p>\n        <div class="btn-group" role="group" aria-label="...">\n            <button type="button" class="btn btn-default">官方标配</button>\n            <button type="button" class="btn btn-default">充电组合</button>\n            <button type="button" class="btn btn-default">碎屏保套餐</button>\n            <button type="button" class="btn btn-default">POP2s套餐</button>\n        </div>\n        <p>花呗分期</p>\n        <div class="btn-group" role="group" aria-label="...">\n            <button type="button" class="btn btn-default">￥'+n.toFixed(2)+'×3期</button>\n            <button type="button" class="btn btn-default">￥'+e.toFixed(2)+'×6期</button>\n            <button type="button" class="btn btn-default">￥'+o.toFixed(2)+'×12期</button>\n            \n        </div>\n\n        <div class="btn_buy">\n            <button class="btn btn-warning btn-lg" id="goCar">立即购买</button>\n            <button class="btn btn-danger btn-lg" id="addCar">加入购物车</button>\n        </div>\n    </div>\n</div>\n\n<ul class="nav nav-tabs">\n    <li role="presentation" class="active"><a href="#">详情</a></li>\n</ul>\n<div class="goods_detail">\n    <img src="'+t.goods_detail+'" alt="" class="img_detail">\n    <img src="'+t.goods_detail_1+'" alt="" class="img_detail">\n</div>\n    ',$(".container").html(str)}function enlarge(){$(".show1").hover(function(){$(".mask").show(),$(".enlarge").show(),setStyle();var t=$(".media-object").attr("src");$(".enlarge").css("backgroundImage","url("+t+")")},function(){$(".mask").hide(),$(".enlarge").hide()}),$(".show1").on("mousemove",function(t){move(t)})}function setStyle(){var t=document.querySelector(".mask"),n=document.querySelector(".enlarge"),e=document.querySelector(".show1"),o=getStyle(n,"backgroundSize");bgX=parseInt(o.split(" ")[0]),bgY=parseInt(o.split(" ")[1]);o=t.offsetWidth,t=t.offsetHeight;showW=e.offsetWidth,showH=e.offsetHeight;o=bgX*o/showW,t=bgY*t/showH;n.style.width=o+"px",n.style.height=t+"px"}function move(t){var n=document.querySelector(".box1"),e=document.querySelector(".mask"),o=document.querySelector(".show1"),s=document.querySelector(".enlarge"),a=getStyle(s,"backgroundSize");bgX=parseInt(a.split(" ")[0]),bgY=parseInt(a.split(" ")[1]);a=t.clientX-n.offsetLeft-e.offsetWidth/2,n=t.pageY-n.offsetTop-e.offsetHeight/2;n<=0&&(n=0),(a=a<=0?0:a)>=o.offsetWidth-e.offsetWidth&&(a=o.offsetWidth-e.offsetWidth),n>=o.offsetHeight-e.offsetHeight&&(n=o.offsetHeight-e.offsetHeight),e.style.left=a+"px",e.style.top=n+"px";a=a*bgX/o.offsetWidth,o=n*bgY/o.offsetHeight;s.style.backgroundPosition=-a+"px "+-o+"px"}function getStyle(t,n){n=(window.getComputedStyle?window.getComputedStyle(t):t.currentStyle)[n];return n}$(".container").on("click",function(t){if("goCar"==t.target.id&&(location.href="../html/car.html"),"addCar"==t.target.id){t=getCookie("login");if(!t)return alert("没有登录请到登录页面进行登录"),localStorage.setItem("url",location.href),void(location.href="../html/login.html");alert("添加成功"),$.ajax({url:"../api/addCar.php",type:"post",data:{goods_id:id,userName:t},dataType:"json",success:function(t){console.log(t)}})}});